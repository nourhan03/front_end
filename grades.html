<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تحليل الأداء الأكاديمي</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        html, body {
            overflow-y: auto;
            margin: 0;
            padding: 0;
            direction: rtl;
            font-family: Tahoma, sans-serif;
            background-color: #f7fafd;
        }
        
        .student-sidebar {
            background-color: #003366;
            color: white;
            min-width: 230px;
            position: fixed;
            right: 0;
            top: 0;
            height: 100vh;
            z-index: 1000;
        }
        
        .student-sidebar .title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: white;
        }
        
        .student-sidebar .nav-link {
            color: #ddd;
            margin: 2px;
            align-items: center;
            display: flex;
            flex-direction: row;
            padding: 8px 12px;
            border-radius: 4px;
            text-decoration: none;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        .student-sidebar .nav-link i {
            margin-left: 10px;
            width: 24px;
            text-align: center;
        }
        
        .student-sidebar .nav-link.active {
            background-color: #ffc107;
            color: white;
        }
        
        .student-sidebar .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.176);
            color: white !important;
        }
        
        .main-content {
            margin-right: 230px;
            padding: 40px;
        }
        
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .header h2 {
            color: #003366;
            font-weight: 700;
        }
        
        .performance-card {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 51, 102, 0.1);
            padding: 25px;
            margin-bottom: 25px;
            border-right: 5px solid #ffc107;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        
        .performance-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 51, 102, 0.15);
        }
        
        .performance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .performance-card h5 {
            color: #003366;
            font-weight: 600;
            margin: 0;
            font-size: 18px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-item {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #003366 0%, #004080 100%);
            border-radius: 12px;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        
        .stat-item:hover::before {
            transform: translateX(100%);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #ffc107;
        }
        
        .stat-label {
            color: #e0e0e0;
            font-size: 14px;
            font-weight: 500;
        }
        
        .chart-container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 51, 102, 0.1);
            padding: 25px;
            margin-bottom: 25px;
        }
        
        .chart-container h5 {
            color: #003366;
            font-weight: 600;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .loading {
            text-align: center;
            padding: 60px;
            color: #003366;
        }
        
        .loading i {
            color: #ffc107;
            margin-bottom: 15px;
        }
        
        .error-message {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .gpa-trend {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .gpa-trend h4 {
            color: #ffc107;
            margin-bottom: 10px;
        }
        
        .semester-performance {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .semester-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #dee2e6;
            transition: all 0.3s ease;
        }
        
        .semester-item:hover {
            border-color: #ffc107;
            transform: translateY(-3px);
        }
        
        .semester-name {
            font-weight: 600;
            color: #003366;
            margin-bottom: 8px;
        }
        
        .semester-score {
            font-size: 20px;
            font-weight: bold;
            color: #28a745;
        }
        
        .insights-section {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .insights-section h6 {
            color: #003366;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .insight-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-right: 4px solid #ffc107;
        }
        
        .suggestions-list {
            list-style: none;
            padding: 0;
        }
        
        .suggestions-list li {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            border-right: 4px solid #ffc107;
            color: #856404;
        }
        
        .suggestions-list li::before {
            content: "💡";
            margin-left: 8px;
        }
        
        .performance-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .badge-excellent {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .badge-good {
            background: linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%);
            color: white;
        }
        
        .badge-improving {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
            color: white;
        }
        
        /* تنسيق تقييم المخاطر */
        .risk-overview {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #dee2e6;
        }
        
        .risk-score h4 {
            color: #003366;
            margin-bottom: 10px;
        }
        
        .risk-factors-section,
        .mitigation-section,
        .monitoring-section {
            margin: 25px 0;
        }
        
        .risk-factors-section h6,
        .mitigation-section h6,
        .monitoring-section h6 {
            color: #003366;
            font-weight: 600;
            margin-bottom: 15px;
            border-bottom: 2px solid #ffc107;
            padding-bottom: 8px;
        }
        
        .risk-factor-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .factor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .severity-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .severity-منخفض {
            background-color: #28a745;
            color: white;
        }
        
        .severity-متوسط {
            background-color: #ffc107;
            color: #212529;
        }
        
        .severity-عالي {
            background-color: #dc3545;
            color: white;
        }
        
        .mitigation-list {
            list-style: none;
            padding: 0;
        }
        
        .mitigation-list li {
            background: white;
            border-radius: 8px;
            padding: 12px 15px;
            margin: 8px 0;
            border-left: 4px solid #28a745;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .mitigation-list li i {
            color: #28a745;
            margin-left: 8px;
        }
        
        .monitoring-areas {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .monitoring-badge {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .badge-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .badge-warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
            color: white;
        }
        
        .badge-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
        }
        
        /* تنسيق تحليل المواد */
        .course-overview,
        .attendance-overview {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #dee2e6;
        }
        
        .course-stats,
        .attendance-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .performance-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .performance-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border-left: 4px solid;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .performance-item.excellent {
            border-left-color: #28a745;
        }
        
        .performance-item.good {
            border-left-color: #17a2b8;
        }
        
        .performance-item.average {
            border-left-color: #ffc107;
        }
        
        .performance-item.below-average {
            border-left-color: #dc3545;
        }
        
        .performance-label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #003366;
        }
        
        .performance-count {
            display: block;
            font-size: 24px;
            font-weight: bold;
            color: #003366;
        }
        
        .course-performance-section,
        .difficult-courses-section,
        .strong-courses-section,
        .course-attendance-section,
        .attendance-patterns-section,
        .attendance-recommendations-section {
            margin: 25px 0;
        }
        
        .course-performance-section h6,
        .difficult-courses-section h6,
        .strong-courses-section h6,
        .course-attendance-section h6,
        .attendance-patterns-section h6,
        .attendance-recommendations-section h6 {
            color: #003366;
            font-weight: 600;
            margin-bottom: 15px;
            border-bottom: 2px solid #ffc107;
            padding-bottom: 8px;
        }
        
        .course-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .course-item.difficult {
            border-left: 4px solid #dc3545;
        }
        
        .course-item.strong {
            border-left: 4px solid #28a745;
        }
        
        .course-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .difficulty-badge {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .course-attendance-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .course-attendance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 12px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .course-name {
            font-weight: 600;
            color: #003366;
        }
        
        .attendance-rate {
            font-weight: bold;
            font-size: 16px;
        }
        
        .attendance-patterns {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .pattern-item {
            background: white;
            padding: 12px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .recommendations-list {
            list-style: none;
            padding: 0;
        }
        
        .recommendations-list li {
            background: white;
            border-radius: 8px;
            padding: 12px 15px;
            margin: 8px 0;
            border-left: 4px solid #17a2b8;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .recommendations-list li i {
            color: #17a2b8;
            margin-left: 8px;
        }
        
        /* تنسيق ملخص الإنذارات */
        .warnings-overview,
        .peer-overview {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #dee2e6;
        }
        
        .warnings-stats,
        .peer-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .warnings-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .warning-types,
        .warning-severity {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .warning-type-item,
        .severity-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 12px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .severity-item.high {
            border-left: 4px solid #dc3545;
        }
        
        .severity-item.medium {
            border-left: 4px solid #ffc107;
        }
        
        .severity-item.low {
            border-left: 4px solid #28a745;
        }
        
        .warning-count,
        .severity-count {
            font-weight: bold;
            color: #003366;
        }
        
        .recent-warnings {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .warning-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .warning-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .warning-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .warning-status.active {
            background-color: #dc3545;
            color: white;
        }
        
        .warning-status.resolved {
            background-color: #28a745;
            color: white;
        }
        
        /* تنسيق مقارنة الأقران */
        .gpa-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .gpa-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .gpa-item.student {
            border-left: 4px solid #003366;
        }
        
        .gpa-item.average {
            border-left: 4px solid #17a2b8;
        }
        
        .gpa-item.median {
            border-left: 4px solid #ffc107;
        }
        
        .gpa-label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #003366;
        }
        
        .gpa-value {
            display: block;
            font-size: 20px;
            font-weight: bold;
            color: #003366;
        }
        
        .performance-ranking {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .ranking-item {
            background: white;
            border-radius: 8px;
            padding: 12px 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .ranking-category {
            display: block;
            font-weight: 600;
            color: #003366;
            margin-bottom: 5px;
        }
        
        .ranking-value {
            color: #28a745;
            font-weight: 600;
        }
        
        .peer-benchmarks {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .benchmark-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .benchmark-item.top-10 {
            border-left: 4px solid #28a745;
        }
        
        .benchmark-item.top-25 {
            border-left: 4px solid #17a2b8;
        }
        
        .benchmark-item.median {
            border-left: 4px solid #ffc107;
        }
        
        .benchmark-item.bottom-25 {
            border-left: 4px solid #dc3545;
        }
        
        .benchmark-label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #003366;
        }
        
        .benchmark-value {
            display: block;
            font-size: 18px;
            font-weight: bold;
            color: #003366;
        }
        
        /* تنسيق التوقعات */
        .graduation-prediction-section,
        .gpa-predictions-section,
        .risk-predictions-section,
        .predictions-recommendations-section {
            margin: 25px 0;
        }
        
        .graduation-prediction-section h6,
        .gpa-predictions-section h6,
        .risk-predictions-section h6,
        .predictions-recommendations-section h6 {
            color: #003366;
            font-weight: 600;
            margin-bottom: 15px;
            border-bottom: 2px solid #ffc107;
            padding-bottom: 8px;
        }
        
        .graduation-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .graduation-item {
            margin: 10px 0;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .graduation-item:last-child {
            border-bottom: none;
        }
        
        .gpa-predictions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .prediction-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #17a2b8;
        }
        
        .prediction-period {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
            color: #003366;
        }
        
        .prediction-value {
            display: block;
            font-size: 20px;
            font-weight: bold;
            color: #17a2b8;
        }
        
        .risk-predictions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .risk-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .risk-type {
            font-weight: 600;
            color: #003366;
        }
        
        .risk-probability {
            font-weight: bold;
            color: #dc3545;
            font-size: 18px;
        }
        
        .predictions-recommendations {
            list-style: none;
            padding: 0;
        }
        
        .predictions-recommendations li {
            background: white;
            border-radius: 8px;
            padding: 12px 15px;
            margin: 8px 0;
            border-left: 4px solid #28a745;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .predictions-recommendations li i {
            color: #28a745;
            margin-left: 8px;
        }
        
        .badge-info {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
            color: white;
        }
        
        .badge-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
        }
        
        .text-success {
            color: #28a745 !important;
        }
        
        .text-warning {
            color: #ffc107 !important;
        }
    </style>
</head>
<body>
    <nav class="student-sidebar p-3">
        <div class="text-center mb-4">
            <h5 class="title">صفحة الطالب<br>بكلية العلوم - جامعة الفيوم</h5>
            <img src="images/3d-graduate-male-student-with-hat-cartoon-character_10560477.png!f305cw" alt="User" class="rounded-circle" width="60">
            <p class="mb-0">أحمد محمد علي</p>
            <small>رقم القيد: 2022021234</small>
        </div>
        <hr>
        <ul class="nav flex-column">
            <li class="nav-item"><a href="registeredcourses.html" class="nav-link"><i class="bi bi-journal-bookmark-fill"></i> المواد المسجلة</a></li>
            <li class="nav-item"><a href="stucourses.html" class="nav-link"><i class="bi bi-clipboard2-check-fill"></i> تسجيل المواد</a></li>
            <li class="nav-item"><a href="stuschedule.html" class="nav-link"><i class="bi bi-calendar-week"></i> الجدول الدراسي</a></li>
            <li class="nav-item"><a href="stugrades.html" class="nav-link"><i class="bi bi-person-check"></i> الدرجات والنتائج</a></li>
            <li class="nav-item"><a href="stuprofile.html" class="nav-link"><i class="bi bi-person-circle"></i> الملف الشخصي</a></li>
            <li class="nav-item"><a href="grades.html" class="nav-link active"><i class="fas fa-chart-bar"></i> تحليل الاداء الاكاديمي</a></li>
            <li class="nav-item"><a href="acadimeicwarning.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i> الانذارات الاكاديمية</a></li>
            <li class="nav-item"><a href="stupaths.html" class="nav-link"><i class="fas fa-code-branch"></i> المسارات الاكاديمية</a></li>
            <li class="nav-item"><a href="grades.html" class="nav-link"><i class="bi bi-file-earmark-bar-graph"></i> التحقق من اهلية التخرج</a></li>
            <li class="nav-item"><a href="studashboard.html" class="nav-link"><i class="bi bi-speedometer2"></i> التقارير</a></li>
            <li class="nav-item"><a href="#" class="nav-link"><i class="bi bi-box-arrow-right"></i> تسجيل الخروج</a></li>
        </ul>
    </nav>

    <div class="main-content">
        <div class="header">
            <h2><i class="fas fa-chart-bar"></i> تحليل الأداء الأكاديمي</h2>
        </div>
        
        <div id="gpa-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل بيانات تحليل GPA...</p>
            </div>
        </div>
        
        <div id="performance-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل بيانات أنماط الأداء...</p>
            </div>
        </div>
        
        <div id="risk-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل تقييم المخاطر الأكاديمية...</p>
            </div>
        </div>
        
        <div id="course-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل تحليل المواد الدراسية...</p>
            </div>
        </div>
        
        <div id="attendance-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل تحليل الحضور...</p>
            </div>
        </div>
        
        <div id="warnings-summary-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل ملخص الإنذارات...</p>
            </div>
        </div>
        
        <div id="peer-comparison-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل مقارنة الأقران...</p>
            </div>
        </div>
        
        <div id="predictions-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل التوقعات الأكاديمية...</p>
            </div>
        </div>
        
        <div id="interventions-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل التدخلات الأكاديمية...</p>
            </div>
        </div>
        
        <div id="ai-insights-container">
            <div class="loading">
                <i class="fas fa-spinner fa-spin fa-3x"></i>
                <p>جاري تحميل رؤى الذكاء الاصطناعي...</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const enrollmentId = 400285;
            
            // إظهار رسالة التحميل
            document.getElementById('gpa-container').innerHTML = '<div class="alert alert-info">جاري تحميل بيانات تحليل GPA...</div>';
            document.getElementById('performance-container').innerHTML = '<div class="alert alert-info">جاري تحميل بيانات أنماط الأداء...</div>';
            document.getElementById('risk-container').innerHTML = '<div class="alert alert-info">جاري تحميل تقييم المخاطر الأكاديمية...</div>';
            document.getElementById('course-container').innerHTML = '<div class="alert alert-info">جاري تحميل تحليل المواد الدراسية...</div>';
            document.getElementById('attendance-container').innerHTML = '<div class="alert alert-info">جاري تحميل تحليل الحضور...</div>';
            document.getElementById('warnings-summary-container').innerHTML = '<div class="alert alert-info">جاري تحميل ملخص الإنذارات...</div>';
            document.getElementById('peer-comparison-container').innerHTML = '<div class="alert alert-info">جاري تحميل مقارنة الأقران...</div>';
            document.getElementById('predictions-container').innerHTML = '<div class="alert alert-info">جاري تحميل التوقعات الأكاديمية...</div>';
            document.getElementById('interventions-container').innerHTML = '<div class="alert alert-info">جاري تحميل التدخلات الأكاديمية...</div>';
            document.getElementById('ai-insights-container').innerHTML = '<div class="alert alert-info">جاري تحميل رؤى الذكاء الاصطناعي...</div>';
            
            try {
                // استخدام البيانات الثابتة بدلاً من API
                console.log('استخدام البيانات الثابتة...');
                
                // بيانات GPA ثابتة
                const gpaData = {
                    "success": true,
                    "data": {
                        "current_gpa": 3.2,
                        "trend": "متزايد",
                        "interpretation": "معدل تراكمي جيد مع اتجاه إيجابي",
                        "semesters": ["الفصل الأول", "الفصل الثاني", "الفصل الثالث", "الفصل الرابع"],
                        "cumulative_gpas": [2.8, 3.0, 3.1, 3.2]
                    }
                };
                
                // بيانات الأداء ثابتة
                const performanceData = {
                    "success": true,
                    "data": {
                        "pattern": "تحسن مستمر",
                        "optimal_credit_load": "15 ساعة معتمدة",
                        "best_semester": "الفصل الرابع",
                        "semester_performance": {
                            "الفصل الأول": 75.5,
                            "الفصل الثاني": 82.3,
                            "الفصل الثالث": 85.7,
                            "الفصل الرابع": 88.2
                        },
                        "performance_insights": {
                            "semester_analysis": {
                                "average_performance": 82.9,
                                "consistency": "متوسط",
                                "performance_range": {
                                    "lowest": 75.5,
                                    "highest": 88.2,
                                    "difference": 12.7
                                }
                            },
                            "credits_analysis": {
                                "load_recommendation": "الحفاظ على 15 ساعة معتمدة للفصل القادم"
                            },
                            "pattern_analysis": {
                                "current_pattern": "تحسن تدريجي",
                                "expected_trajectory": "استمرار التحسن مع معدل أبطأ"
                            }
                        },
                        "credits_performance": {
                            "3": 85.2,
                            "2": 78.9
                        },
                        "improvement_suggestions": [
                            "التركيز على المواد التي تحتاج 3 ساعات معتمدة",
                            "زيادة ساعات الدراسة للمواد الصعبة",
                            "الاستفادة من المكتبة ومراكز الدعم الأكاديمي",
                            "التواصل مع المدرسين للحصول على إرشادات إضافية"
                        ]
                    }
                };
                
                // محاولة جلب بيانات تقييم المخاطر من API
                console.log('جاري جلب بيانات تقييم المخاطر...');
                let riskResponse;
                try {
                    riskResponse = await fetch(`http://web-production-3489a.up.railway.app/api/academic-status/risk-assessment/400285`);
                    
                    if (!riskResponse.ok) {
                        throw new Error(`خطأ في Risk Assessment API: ${riskResponse.status}`);
                    }
                    
                    const riskData = await riskResponse.json();
                    console.log('بيانات تقييم المخاطر من API:', riskData);
                    displayRiskAssessment(riskData);
                    
                } catch (apiError) {
                    console.log('فشل في جلب بيانات API، استخدام البيانات الثابتة:', apiError);
                    
                    // بيانات تقييم المخاطر ثابتة كبديل
                    const riskData = {
                        "success": true,
                        "data": {
                            "overall_risk_level": "منخفض",
                            "risk_score": 25,
                            "risk_factors": [
                                {
                                    "factor": "انخفاض في الأداء مؤخراً",
                                    "severity": "متوسط",
                                    "description": "تراجع طفيف في الأداء خلال الفصل الحالي"
                                },
                                {
                                    "factor": "غياب عن المحاضرات",
                                    "severity": "منخفض",
                                    "description": "معدل حضور جيد مع بعض الغيابات الطارئة"
                                }
                            ],
                            "mitigation_strategies": [
                                "زيادة ساعات الدراسة الأسبوعية",
                                "التواصل مع المرشد الأكاديمي",
                                "الانضمام لمجموعات الدراسة",
                                "استخدام مصادر التعلم الإضافية"
                            ],
                            "monitoring_areas": [
                                "الأداء في المواد الأساسية",
                                "معدل الحضور",
                                "التسليم في المواعيد المحددة"
                            ]
                        }
                    };
                    
                    displayRiskAssessment(riskData);
                }
                
                // محاولة جلب بيانات تحليل المواد
                console.log('جاري جلب بيانات تحليل المواد...');
                try {
                    const courseResponse = await fetch(`http://web-production-3489a.up.railway.app/api/academic-status/course-analysis/400285`);
                    
                    if (!courseResponse.ok) {
                        throw new Error(`خطأ في Course Analysis API: ${courseResponse.status}`);
                    }
                    
                    const courseData = await courseResponse.json();
                    console.log('بيانات تحليل المواد من API:', courseData);
                    displayCourseAnalysis(courseData);
                    
                } catch (apiError) {
                    console.log('فشل في جلب بيانات تحليل المواد، استخدام البيانات الثابتة:', apiError);
                    
                    // بيانات تحليل المواد ثابتة كبديل
                    const courseData = {
                        "success": true,
                        "data": {
                            "total_courses": 8,
                            "completed_courses": 6,
                            "current_courses": 2,
                            "course_performance": {
                                "excellent": 3,
                                "good": 2,
                                "average": 1,
                                "below_average": 0
                            },
                            "difficult_courses": [
                                {
                                    "course_name": "الرياضيات المتقدمة",
                                    "difficulty_level": "عالي",
                                    "current_grade": "B-",
                                    "recommendations": ["زيادة ساعات الدراسة", "التواصل مع المدرس"]
                                }
                            ],
                            "strong_courses": [
                                {
                                    "course_name": "البرمجة",
                                    "performance": "ممتاز",
                                    "current_grade": "A+",
                                    "strengths": ["فهم عميق", "ممارسة مستمرة"]
                                }
                            ]
                        }
                    };
                    
                    displayCourseAnalysis(courseData);
                }
                
                // محاولة جلب بيانات تحليل الحضور
                console.log('جاري جلب بيانات تحليل الحضور...');
                try {
                    const attendanceResponse = await fetch(`http://web-production-3489a.up.railway.app/api/academic-status/attendance-analysis/400285`);
                    
                    if (!attendanceResponse.ok) {
                        throw new Error(`خطأ في Attendance Analysis API: ${attendanceResponse.status}`);
                    }
                    
                    const attendanceData = await attendanceResponse.json();
                    console.log('بيانات تحليل الحضور من API:', attendanceData);
                    displayAttendanceAnalysis(attendanceData);
                    
                } catch (apiError) {
                    console.log('فشل في جلب بيانات تحليل الحضور، استخدام البيانات الثابتة:', apiError);
                    
                    // بيانات تحليل الحضور ثابتة كبديل
                    const attendanceData = {
                        "success": true,
                        "data": {
                            "overall_attendance_rate": 92.5,
                            "total_sessions": 120,
                            "attended_sessions": 111,
                            "missed_sessions": 9,
                            "attendance_trend": "مستقر",
                            "course_attendance": {
                                "الرياضيات المتقدمة": 88.0,
                                "البرمجة": 95.0,
                                "الفيزياء": 90.5,
                                "الكيمياء": 94.2
                            },
                            "attendance_patterns": {
                                "best_day": "الأحد",
                                "worst_day": "الخميس",
                                "late_arrivals": 3,
                                "early_leaves": 1
                            },
                            "recommendations": [
                                "تحسين الحضور في يوم الخميس",
                                "الوصول مبكراً للمحاضرات",
                                "التواصل مع المدرسين في حالة الغياب"
                            ]
                        }
                    };
                    
                    displayAttendanceAnalysis(attendanceData);
                }
                
                // محاولة جلب بيانات ملخص الإنذارات
                console.log('جاري جلب بيانات ملخص الإنذارات...');
                try {
                    const warningsResponse = await fetch(`http://web-production-3489a.up.railway.app/api/academic-status/warnings-summary/400285`);
                    
                    if (!warningsResponse.ok) {
                        throw new Error(`خطأ في Warnings Summary API: ${warningsResponse.status}`);
                    }
                    
                    const warningsData = await warningsResponse.json();
                    console.log('بيانات ملخص الإنذارات من API:', warningsData);
                    displayWarningsSummary(warningsData);
                    
                } catch (apiError) {
                    console.log('فشل في جلب بيانات ملخص الإنذارات، استخدام البيانات الثابتة:', apiError);
                    
                    // بيانات ملخص الإنذارات ثابتة كبديل
                    const warningsData = {
                        "success": true,
                        "data": {
                            "total_warnings": 2,
                            "active_warnings": 1,
                            "resolved_warnings": 1,
                            "warning_types": {
                                "academic": 1,
                                "attendance": 1,
                                "behavioral": 0
                            },
                            "warning_severity": {
                                "high": 0,
                                "medium": 1,
                                "low": 1
                            },
                            "recent_warnings": [
                                {
                                    "type": "أكاديمي",
                                    "date": "2024-01-15",
                                    "status": "نشط",
                                    "description": "انخفاض في الأداء الأكاديمي"
                                }
                            ],
                            "resolution_rate": 50.0
                        }
                    };
                    
                    displayWarningsSummary(warningsData);
                }
                
                // محاولة جلب بيانات مقارنة الأقران
                console.log('جاري جلب بيانات مقارنة الأقران...');
                try {
                    const peerResponse = await fetch(`http://web-production-3489a.up.railway.app/api/academic-status/peer-comparison/400285`);
                    
                    if (!peerResponse.ok) {
                        throw new Error(`خطأ في Peer Comparison API: ${peerResponse.status}`);
                    }
                    
                    const peerData = await peerResponse.json();
                    console.log('بيانات مقارنة الأقران من API:', peerData);
                    displayPeerComparison(peerData);
                    
                } catch (apiError) {
                    console.log('فشل في جلب بيانات مقارنة الأقران، استخدام البيانات الثابتة:', apiError);
                    
                    // بيانات مقارنة الأقران ثابتة كبديل
                    const peerData = {
                        "success": true,
                        "data": {
                            "class_rank": 15,
                            "total_students": 45,
                            "percentile": 67,
                            "gpa_comparison": {
                                "student_gpa": 3.2,
                                "class_average": 3.1,
                                "class_median": 3.0,
                                "class_std": 0.4
                            },
                            "performance_ranking": {
                                "overall": "أعلى من المتوسط",
                                "gpa": "أعلى من المتوسط",
                                "attendance": "متوسط",
                                "participation": "جيد"
                            },
                            "peer_benchmarks": {
                                "top_10_percent": 3.8,
                                "top_25_percent": 3.5,
                                "median": 3.0,
                                "bottom_25_percent": 2.5
                            }
                        }
                    };
                    
                    displayPeerComparison(peerData);
                }
                
                // محاولة جلب بيانات التوقعات
                console.log('جاري جلب بيانات التوقعات...');
                try {
                    const predictionsResponse = await fetch(`http://web-production-3489a.up.railway.app/api/academic-status/predictions/400285`);
                    
                    if (!predictionsResponse.ok) {
                        throw new Error(`خطأ في Predictions API: ${predictionsResponse.status}`);
                    }
                    
                    const predictionsData = await predictionsResponse.json();
                    console.log('بيانات التوقعات من API:', predictionsData);
                    displayPredictions(predictionsData);
                    
                } catch (apiError) {
                    console.log('فشل في جلب بيانات التوقعات، استخدام البيانات الثابتة:', apiError);
                    
                    // بيانات التوقعات ثابتة كبديل
                    const predictionsData = {
                        "success": true,
                        "data": {
                            "graduation_prediction": {
                                "expected_graduation": "2025",
                                "confidence": 85,
                                "on_track": true
                            },
                            "gpa_predictions": {
                                "next_semester": 3.3,
                                "end_of_year": 3.4,
                                "graduation": 3.5
                            },
                            "risk_predictions": {
                                "academic_probation": 5,
                                "course_failure": 10,
                                "attendance_issues": 15
                            },
                            "recommendations": [
                                "الحفاظ على معدل الدراسة الحالي",
                                "التركيز على المواد الصعبة",
                                "تحسين الحضور في المحاضرات"
                            ]
                        }
                    };
                    
                    displayPredictions(predictionsData);
                }
                
                // محاولة جلب بيانات التدخلات الأكاديمية
                console.log('جاري جلب بيانات التدخلات الأكاديمية...');
                try {
                    const interventionsResponse = await fetch(`http://web-production-3489a.up.railway.app/api/academic-status/interventions/400285`);
                    
                    if (!interventionsResponse.ok) {
                        throw new Error(`خطأ في Interventions API: ${interventionsResponse.status}`);
                    }
                    
                    const interventionsData = await interventionsResponse.json();
                    console.log('بيانات التدخلات من API:', interventionsData);
                    displayInterventions(interventionsData);
                    
                } catch (apiError) {
                    console.log('فشل في جلب بيانات التدخلات، استخدام البيانات الثابتة:', apiError);
                    
                    // بيانات التدخلات ثابتة كبديل
                    const interventionsData = {
                        "success": true,
                        "data": {
                            "recommended_interventions": [
                                {
                                    "title": "جلسات دعم أكاديمي",
                                    "description": "الانضمام لجلسات دعم في مادة الرياضيات المتقدمة.",
                                    "status": "موصى بها"
                                },
                                {
                                    "title": "استشارة مرشد أكاديمي",
                                    "description": "مقابلة مع المرشد الأكاديمي لمناقشة الأداء.",
                                    "status": "موصى بها"
                                }
                            ],
                            "completed_interventions": [
                                {
                                    "title": "ورشة عمل إدارة الوقت",
                                    "description": "تم حضور ورشة عمل حول إدارة الوقت.",
                                    "status": "مكتملة"
                                }
                            ]
                        }
                    };
                    
                    displayInterventions(interventionsData);
                }
                
                // محاولة جلب بيانات رؤى الذكاء الاصطناعي
                console.log('جاري جلب بيانات رؤى الذكاء الاصطناعي...');
                try {
                    const aiInsightsResponse = await fetch(`http://web-production-3489a.up.railway.app/api/academic-status/ai-insights/400285`);
                    
                    if (!aiInsightsResponse.ok) {
                        throw new Error(`خطأ في AI Insights API: ${aiInsightsResponse.status}`);
                    }
                    
                    const aiInsightsData = await aiInsightsResponse.json();
                    console.log('بيانات رؤى الذكاء الاصطناعي من API:', aiInsightsData);
                    displayAIInsights(aiInsightsData);
                    
                } catch (apiError) {
                    console.log('فشل في جلب بيانات رؤى الذكاء الاصطناعي، استخدام البيانات الثابتة:', apiError);
                    
                    // بيانات رؤى الذكاء الاصطناعي ثابتة كبديل
                    const aiInsightsData = {
                        "success": true,
                        "data": {
                            "personalized_tips": [
                                "ركز على مراجعة مادة الرياضيات المتقدمة قبل الامتحان القادم.",
                                "حافظ على معدل الحضور المرتفع في جميع المواد.",
                                "استفد من مصادر التعلم الإلكترونية المتاحة."
                            ],
                            "ai_flags": [
                                {
                                    "type": "تحذير",
                                    "message": "انخفاض طفيف في أداء مادة الفيزياء مقارنة بالفصول السابقة."
                                }
                            ],
                            "ai_opportunities": [
                                {
                                    "type": "فرصة",
                                    "message": "يمكنك تحسين المعدل العام إذا واصلت الأداء الحالي في مادة البرمجة."
                                }
                            ]
                        }
                    };
                    
                    displayAIInsights(aiInsightsData);
                }

                console.log('بيانات GPA:', gpaData);
                console.log('بيانات الأداء:', performanceData);
                
                // عرض البيانات
                displayGpaAnalysis(gpaData);
                displayPerformancePatterns(performanceData);
                
            } catch (error) {
                console.error('خطأ في عرض البيانات:', error);
                document.getElementById('gpa-container').innerHTML = `
                    <div class="alert alert-danger">
                        <h5><i class="fas fa-exclamation-triangle"></i> خطأ في عرض بيانات GPA</h5>
                        <p><strong>تفاصيل الخطأ:</strong> ${error.message}</p>
                    </div>
                `;
                document.getElementById('performance-container').innerHTML = `
                    <div class="alert alert-danger">
                        <h5><i class="fas fa-exclamation-triangle"></i> خطأ في عرض بيانات الأداء</h5>
                        <p><strong>تفاصيل الخطأ:</strong> ${error.message}</p>
                    </div>
                `;
                document.getElementById('risk-container').innerHTML = `
                    <div class="alert alert-danger">
                        <h5><i class="fas fa-exclamation-triangle"></i> خطأ في عرض بيانات تقييم المخاطر</h5>
                        <p><strong>تفاصيل الخطأ:</strong> ${error.message}</p>
                    </div>
                `;
            }
        });
        
        function displayGpaAnalysis(data) {
            const container = document.getElementById('gpa-container');
            console.log('بيانات GPA المستلمة:', data);
            
            // التحقق من هيكل البيانات
            let gpaData = data;
            if (data && data.data) {
                gpaData = data.data;
            }
            
            if (gpaData && gpaData.current_gpa !== undefined) {
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-chart-line"></i> تحليل المعدل التراكمي</h5>
                            <span class="performance-badge badge-${getPerformanceBadgeClass(gpaData.current_gpa)}">
                                ${gpaData.trend || 'متوسط'}
                            </span>
                        </div>
                        
                        <div class="gpa-trend">
                            <h4>المعدل التراكمي الحالي: ${gpaData.current_gpa}</h4>
                            <p><strong>التفسير:</strong> ${gpaData.interpretation || 'لا يوجد تفسير متاح'}</p>
                        </div>
                        <div class="insights-section">
                            <h6><i class="fas fa-info-circle"></i> تطور المعدل التراكمي عبر الفصول الدراسية</h6>
                            <div class="insight-item">
                                <strong>الفصول الدراسية:</strong> ${gpaData.semesters ? gpaData.semesters.join('، ') : 'غير متاح'}
                            </div>
                            <div class="insight-item">
                                <strong>المعدلات التراكمية لكل فصل:</strong> ${gpaData.cumulative_gpas ? gpaData.cumulative_gpas.join('، ') : 'غير متاح'}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات GPA متاحة أو البيانات غير مكتملة</div>';
            }
        }
        
        function displayPerformancePatterns(data) {
            const container = document.getElementById('performance-container');
            console.log('بيانات الأداء المستلمة:', data);
            
            // التحقق من هيكل البيانات
            let performanceData = data;
            if (data && data.data) {
                performanceData = data.data;
            }
            
            if (performanceData && performanceData.pattern) {
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-tachometer-alt"></i> أنماط الأداء الأكاديمي</h5>
                            <span class="performance-badge badge-improving">
                                ${performanceData.pattern}
                            </span>
                        </div>
                        
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-value">${performanceData.performance_insights?.semester_analysis?.average_performance?.toFixed(1) || 'N/A'}%</div>
                                <div class="stat-label">متوسط الأداء</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${performanceData.optimal_credit_load || 'N/A'}</div>
                                <div class="stat-label">الحمل الدراسي الأمثل</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${performanceData.best_semester || 'N/A'}</div>
                                <div class="stat-label">أفضل فصل دراسي</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${performanceData.performance_insights?.semester_analysis?.performance_range?.highest?.toFixed(1) || 'N/A'}%</div>
                                <div class="stat-label">أعلى أداء</div>
                            </div>
                        </div>
                        <div class="insights-section">
                            <h6><i class="fas fa-info-circle"></i> الأداء حسب الفصول الدراسية</h6>
                            <div class="insight-item">
                                <strong>تفاصيل الأداء لكل فصل:</strong><br>
                                ${performanceData.semester_performance ? Object.entries(performanceData.semester_performance).map(([semester, score]) => `
                                    <span>${semester}: ${score.toFixed(1)}%</span>`).join('<br>') : 'لا توجد بيانات للفصول الدراسية'}
                            </div>
                        </div>
                    </div>
                    
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-calendar-alt"></i> تفاصيل الأداء حسب الفصول الدراسية</h5>
                        </div>
                        <div class="semester-performance">
                            ${performanceData.semester_performance ? Object.entries(performanceData.semester_performance).map(([semester, score]) => `
                                <div class="semester-item">
                                    <div class="semester-name">${semester}</div>
                                    <div class="semester-score">${score.toFixed(1)}%</div>
                                </div>
                            `).join('') : '<p>لا توجد بيانات للفصول الدراسية</p>'}
                        </div>
                    </div>
                    
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-lightbulb"></i> الرؤى والتحليلات</h5>
                        </div>
                        
                        <div class="insights-section">
                            <h6><i class="fas fa-chart-pie"></i> تحليل الاتساق</h6>
                            <div class="insight-item">
                                <strong>مستوى الاتساق:</strong> ${performanceData.performance_insights?.semester_analysis?.consistency || 'غير متاح'}
                            </div>
                            <div class="insight-item">
                                <strong>نطاق الأداء:</strong> 
                                ${performanceData.performance_insights?.semester_analysis?.performance_range ? 
                                    `من ${performanceData.performance_insights.semester_analysis.performance_range.lowest.toFixed(1)}% إلى ${performanceData.performance_insights.semester_analysis.performance_range.highest.toFixed(1)}% (فرق: ${performanceData.performance_insights.semester_analysis.performance_range.difference.toFixed(1)}%)` : 
                                    'غير متاح'}
                            </div>
                        </div>
                        
                        <div class="insights-section">
                            <h6><i class="fas fa-graduation-cap"></i> تحليل الحمل الدراسي</h6>
                            <div class="insight-item">
                                <strong>الأداء حسب الساعات المعتمدة:</strong>
                                ${performanceData.credits_performance ? 
                                    `<br>• 3 ساعات: ${performanceData.credits_performance['3']?.toFixed(1) || 'N/A'}%
                                    <br>• 2 ساعة: ${performanceData.credits_performance['2']?.toFixed(1) || 'N/A'}%` : 
                                    '<br>غير متاح'}
                            </div>
                            <div class="insight-item">
                                <strong>التوصية:</strong> ${performanceData.performance_insights?.credits_analysis?.load_recommendation || 'غير متاح'}
                            </div>
                        </div>
                        
                        <div class="insights-section">
                            <h6><i class="fas fa-rocket"></i> التوقعات المستقبلية</h6>
                            <div class="insight-item">
                                <strong>النمط الحالي:</strong> ${performanceData.performance_insights?.pattern_analysis?.current_pattern || 'غير متاح'}
                            </div>
                            <div class="insight-item">
                                <strong>التوقعات:</strong> ${performanceData.performance_insights?.pattern_analysis?.expected_trajectory || 'غير متاح'}
                            </div>
                        </div>
                    </div>
                    
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-tools"></i> اقتراحات التحسين</h5>
                        </div>
                        
                        <ul class="suggestions-list">
                            ${performanceData.improvement_suggestions ? performanceData.improvement_suggestions.map(suggestion => `
                                <li>${suggestion}</li>
                            `).join('') : '<li>لا توجد اقتراحات متاحة</li>'}
                        </ul>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات الأداء متاحة أو البيانات غير مكتملة</div>';
            }
        }
        
        function getPerformanceBadgeClass(gpa) {
            if (gpa >= 3.5) return 'excellent';
            if (gpa >= 2.5) return 'good';
            return 'improving';
        }
        
        function displayRiskAssessment(data) {
            const container = document.getElementById('risk-container');
            console.log('بيانات تقييم المخاطر المستلمة:', data);
            
            // التحقق من هيكل البيانات
            let riskData = data;
            if (data && data.data) {
                riskData = data.data;
            }
            
            if (riskData && riskData.overall_risk_level) {
                const riskLevelClass = getRiskLevelClass(riskData.overall_risk_level);
                const riskScoreColor = getRiskScoreColor(riskData.risk_score);
                
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-shield-alt"></i> تقييم المخاطر الأكاديمية</h5>
                            <span class="performance-badge ${riskLevelClass}">
                                ${riskData.overall_risk_level}
                            </span>
                        </div>
                        
                        <div class="risk-overview">
                            <div class="risk-score">
                                <h4>مؤشر المخاطر: <span style="color: ${riskScoreColor}">${riskData.risk_score}%</span></h4>
                                <p><strong>التقييم:</strong> ${riskData.overall_risk_level === 'منخفض' ? 'مستوى مخاطر مقبول' : 
                                    riskData.overall_risk_level === 'متوسط' ? 'يحتاج إلى مراقبة' : 'يحتاج إلى تدخل فوري'}</p>
                            </div>
                        </div>
                        
                        <div class="risk-factors-section">
                            <h6><i class="fas fa-exclamation-triangle"></i> عوامل المخاطر</h6>
                            <div class="risk-factors">
                                ${riskData.risk_factors ? riskData.risk_factors.map(factor => `
                                    <div class="risk-factor-item">
                                        <div class="factor-header">
                                            <strong>${factor.factor}</strong>
                                            <span class="severity-badge severity-${factor.severity}">${factor.severity}</span>
                                        </div>
                                        <p>${factor.description}</p>
                                    </div>
                                `).join('') : '<p>لا توجد عوامل مخاطر محددة</p>'}
                            </div>
                        </div>
                        
                        <div class="mitigation-section">
                            <h6><i class="fas fa-tools"></i> استراتيجيات التخفيف</h6>
                            <ul class="mitigation-list">
                                ${riskData.mitigation_strategies ? riskData.mitigation_strategies.map(strategy => `
                                    <li><i class="fas fa-check-circle"></i> ${strategy}</li>
                                `).join('') : '<li>لا توجد استراتيجيات محددة</li>'}
                            </ul>
                        </div>
                        
                        <div class="monitoring-section">
                            <h6><i class="fas fa-eye"></i> مجالات المراقبة</h6>
                            <div class="monitoring-areas">
                                ${riskData.monitoring_areas ? riskData.monitoring_areas.map(area => `
                                    <span class="monitoring-badge">${area}</span>
                                `).join('') : '<p>لا توجد مجالات مراقبة محددة</p>'}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات تقييم المخاطر متاحة</div>';
            }
        }
        
        function getRiskLevelClass(riskLevel) {
            switch(riskLevel) {
                case 'منخفض': return 'badge-success';
                case 'متوسط': return 'badge-warning';
                case 'عالي': return 'badge-danger';
                default: return 'badge-secondary';
            }
        }
        
        function getRiskScoreColor(score) {
            if (score <= 30) return '#28a745';
            if (score <= 60) return '#ffc107';
            return '#dc3545';
        }
        
        function displayCourseAnalysis(data) {
            const container = document.getElementById('course-container');
            console.log('بيانات تحليل المواد المستلمة:', data);
            
            // التحقق من هيكل البيانات
            let courseData = data;
            if (data && data.data) {
                courseData = data.data;
            }
            
            if (courseData && courseData.total_courses !== undefined) {
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-book"></i> تحليل المواد الدراسية</h5>
                            <span class="performance-badge badge-success">
                                ${courseData.completed_courses}/${courseData.total_courses} مكتملة
                            </span>
                        </div>
                        
                        <div class="course-overview">
                            <div class="course-stats">
                                <div class="stat-item">
                                    <div class="stat-value">${courseData.total_courses}</div>
                                    <div class="stat-label">إجمالي المواد</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${courseData.completed_courses}</div>
                                    <div class="stat-label">مكتملة</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${courseData.current_courses}</div>
                                    <div class="stat-label">حالية</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="course-performance-section">
                            <h6><i class="fas fa-chart-pie"></i> أداء المواد</h6>
                            <div class="performance-breakdown">
                                <div class="performance-item excellent">
                                    <span class="performance-label">ممتاز</span>
                                    <span class="performance-count">${courseData.course_performance?.excellent || 0}</span>
                                </div>
                                <div class="performance-item good">
                                    <span class="performance-label">جيد</span>
                                    <span class="performance-count">${courseData.course_performance?.good || 0}</span>
                                </div>
                                <div class="performance-item average">
                                    <span class="performance-label">متوسط</span>
                                    <span class="performance-count">${courseData.course_performance?.average || 0}</span>
                                </div>
                                <div class="performance-item below-average">
                                    <span class="performance-label">تحت المتوسط</span>
                                    <span class="performance-count">${courseData.course_performance?.below_average || 0}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="difficult-courses-section">
                            <h6><i class="fas fa-exclamation-triangle"></i> المواد الصعبة</h6>
                            <div class="difficult-courses">
                                ${courseData.difficult_courses ? courseData.difficult_courses.map(course => `
                                    <div class="course-item difficult">
                                        <div class="course-header">
                                            <strong>${course.course_name}</strong>
                                            <span class="difficulty-badge">${course.difficulty_level}</span>
                                        </div>
                                        <p><strong>الدرجة الحالية:</strong> ${course.current_grade}</p>
                                        <div class="recommendations">
                                            <strong>التوصيات:</strong>
                                            <ul>
                                                ${course.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                                            </ul>
                                        </div>
                                    </div>
                                `).join('') : '<p>لا توجد مواد صعبة محددة</p>'}
                            </div>
                        </div>
                        
                        <div class="strong-courses-section">
                            <h6><i class="fas fa-star"></i> المواد القوية</h6>
                            <div class="strong-courses">
                                ${courseData.strong_courses ? courseData.strong_courses.map(course => `
                                    <div class="course-item strong">
                                        <div class="course-header">
                                            <strong>${course.course_name}</strong>
                                            <span class="performance-badge badge-success">${course.performance}</span>
                                        </div>
                                        <p><strong>الدرجة الحالية:</strong> ${course.current_grade}</p>
                                        <div class="strengths">
                                            <strong>نقاط القوة:</strong>
                                            <ul>
                                                ${course.strengths.map(strength => `<li>${strength}</li>`).join('')}
                                            </ul>
                                        </div>
                                    </div>
                                `).join('') : '<p>لا توجد مواد قوية محددة</p>'}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات تحليل المواد متاحة</div>';
            }
        }
        
        function displayAttendanceAnalysis(data) {
            const container = document.getElementById('attendance-container');
            console.log('بيانات تحليل الحضور المستلمة:', data);
            
            // التحقق من هيكل البيانات
            let attendanceData = data;
            if (data && data.data) {
                attendanceData = data.data;
            }
            
            if (attendanceData && attendanceData.overall_attendance_rate !== undefined) {
                const attendanceColor = getAttendanceColor(attendanceData.overall_attendance_rate);
                
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-calendar-check"></i> تحليل الحضور</h5>
                            <span class="performance-badge" style="background: ${attendanceColor}">
                                ${attendanceData.overall_attendance_rate}%
                            </span>
                        </div>
                        
                        <div class="attendance-overview">
                            <div class="attendance-stats">
                                <div class="stat-item">
                                    <div class="stat-value">${attendanceData.total_sessions}</div>
                                    <div class="stat-label">إجمالي المحاضرات</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${attendanceData.attended_sessions}</div>
                                    <div class="stat-label">حضر</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${attendanceData.missed_sessions}</div>
                                    <div class="stat-label">غاب</div>
                                </div>
                            </div>
                            <div class="attendance-trend">
                                <p><strong>اتجاه الحضور:</strong> ${attendanceData.attendance_trend}</p>
                            </div>
                        </div>
                        
                        <div class="course-attendance-section">
                            <h6><i class="fas fa-list"></i> الحضور حسب المادة</h6>
                            <div class="course-attendance-list">
                                ${attendanceData.course_attendance ? Object.entries(attendanceData.course_attendance).map(([course, rate]) => `
                                    <div class="course-attendance-item">
                                        <span class="course-name">${course}</span>
                                        <span class="attendance-rate" style="color: ${getAttendanceColor(rate)}">${rate}%</span>
                                    </div>
                                `).join('') : '<p>لا توجد بيانات حضور للمواد</p>'}
                            </div>
                        </div>
                        
                        <div class="attendance-patterns-section">
                            <h6><i class="fas fa-chart-line"></i> أنماط الحضور</h6>
                            <div class="attendance-patterns">
                                <div class="pattern-item">
                                    <strong>أفضل يوم:</strong> ${attendanceData.attendance_patterns?.best_day || 'غير محدد'}
                                </div>
                                <div class="pattern-item">
                                    <strong>أسوأ يوم:</strong> ${attendanceData.attendance_patterns?.worst_day || 'غير محدد'}
                                </div>
                                <div class="pattern-item">
                                    <strong>الوصول متأخر:</strong> ${attendanceData.attendance_patterns?.late_arrivals || 0} مرات
                                </div>
                                <div class="pattern-item">
                                    <strong>مغادرة مبكرة:</strong> ${attendanceData.attendance_patterns?.early_leaves || 0} مرات
                                </div>
                            </div>
                        </div>
                        
                        <div class="attendance-recommendations-section">
                            <h6><i class="fas fa-lightbulb"></i> توصيات الحضور</h6>
                            <ul class="recommendations-list">
                                ${attendanceData.recommendations ? attendanceData.recommendations.map(rec => `
                                    <li><i class="fas fa-check-circle"></i> ${rec}</li>
                                `).join('') : '<li>لا توجد توصيات محددة</li>'}
                            </ul>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات تحليل الحضور متاحة</div>';
            }
        }
        
        function getAttendanceColor(rate) {
            if (rate >= 90) return '#28a745';
            if (rate >= 80) return '#ffc107';
            if (rate >= 70) return '#fd7e14';
            return '#dc3545';
        }
        
        function displayWarningsSummary(data) {
            const container = document.getElementById('warnings-summary-container');
            console.log('بيانات ملخص الإنذارات المستلمة:', data);
            
            // التحقق من هيكل البيانات
            let warningsData = data;
            if (data && data.data) {
                warningsData = data.data;
            }
            
            if (warningsData && warningsData.total_warnings !== undefined) {
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-exclamation-triangle"></i> ملخص الإنذارات الأكاديمية</h5>
                            <span class="performance-badge ${warningsData.active_warnings > 0 ? 'badge-warning' : 'badge-success'}">
                                ${warningsData.active_warnings} نشط
                            </span>
                        </div>
                        
                        <div class="warnings-overview">
                            <div class="warnings-stats">
                                <div class="stat-item">
                                    <div class="stat-value">${warningsData.total_warnings}</div>
                                    <div class="stat-label">إجمالي الإنذارات</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${warningsData.active_warnings}</div>
                                    <div class="stat-label">نشط</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${warningsData.resolved_warnings}</div>
                                    <div class="stat-label">محلول</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${warningsData.resolution_rate}%</div>
                                    <div class="stat-label">معدل الحل</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="warnings-breakdown">
                            <div class="warning-types-section">
                                <h6><i class="fas fa-list"></i> أنواع الإنذارات</h6>
                                <div class="warning-types">
                                    <div class="warning-type-item">
                                        <span class="warning-type">أكاديمي</span>
                                        <span class="warning-count">${warningsData.warning_types?.academic || 0}</span>
                                    </div>
                                    <div class="warning-type-item">
                                        <span class="warning-type">حضور</span>
                                        <span class="warning-count">${warningsData.warning_types?.attendance || 0}</span>
                                    </div>
                                    <div class="warning-type-item">
                                        <span class="warning-type">سلوكي</span>
                                        <span class="warning-count">${warningsData.warning_types?.behavioral || 0}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="warning-severity-section">
                                <h6><i class="fas fa-chart-bar"></i> مستوى الخطورة</h6>
                                <div class="warning-severity">
                                    <div class="severity-item high">
                                        <span class="severity-label">عالي</span>
                                        <span class="severity-count">${warningsData.warning_severity?.high || 0}</span>
                                    </div>
                                    <div class="severity-item medium">
                                        <span class="severity-label">متوسط</span>
                                        <span class="severity-count">${warningsData.warning_severity?.medium || 0}</span>
                                    </div>
                                    <div class="severity-item low">
                                        <span class="severity-label">منخفض</span>
                                        <span class="severity-count">${warningsData.warning_severity?.low || 0}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="recent-warnings-section">
                            <h6><i class="fas fa-clock"></i> الإنذارات الحديثة</h6>
                            <div class="recent-warnings">
                                ${warningsData.recent_warnings ? warningsData.recent_warnings.map(warning => `
                                    <div class="warning-item">
                                        <div class="warning-header">
                                            <strong>${warning.type}</strong>
                                            <span class="warning-status ${warning.status === 'نشط' ? 'active' : 'resolved'}">${warning.status}</span>
                                        </div>
                                        <p>${warning.description}</p>
                                        <small>التاريخ: ${warning.date}</small>
                                    </div>
                                `).join('') : '<p>لا توجد إنذارات حديثة</p>'}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات ملخص الإنذارات متاحة</div>';
            }
        }
        
        function displayPeerComparison(data) {
            const container = document.getElementById('peer-comparison-container');
            console.log('بيانات مقارنة الأقران المستلمة:', data);
            
            // التحقق من هيكل البيانات
            let peerData = data;
            if (data && data.data) {
                peerData = data.data;
            }
            
            if (peerData && peerData.class_rank !== undefined) {
                const percentileClass = getPercentileClass(peerData.percentile);
                
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-users"></i> مقارنة الأقران</h5>
                            <span class="performance-badge ${percentileClass}">
                                المرتبة ${peerData.class_rank} من ${peerData.total_students}
                            </span>
                        </div>
                        
                        <div class="peer-overview">
                            <div class="peer-stats">
                                <div class="stat-item">
                                    <div class="stat-value">${peerData.class_rank}</div>
                                    <div class="stat-label">المرتبة في الفصل</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${peerData.total_students}</div>
                                    <div class="stat-label">إجمالي الطلاب</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">${peerData.percentile}%</div>
                                    <div class="stat-label">النسبة المئوية</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="gpa-comparison-section">
                            <h6><i class="fas fa-chart-line"></i> مقارنة المعدل التراكمي</h6>
                            <div class="gpa-comparison">
                                <div class="gpa-item student">
                                    <span class="gpa-label">معدلك</span>
                                    <span class="gpa-value">${peerData.gpa_comparison?.student_gpa || 'N/A'}</span>
                                </div>
                                <div class="gpa-item average">
                                    <span class="gpa-label">متوسط الفصل</span>
                                    <span class="gpa-value">${peerData.gpa_comparison?.class_average || 'N/A'}</span>
                                </div>
                                <div class="gpa-item median">
                                    <span class="gpa-label">وسيط الفصل</span>
                                    <span class="gpa-value">${peerData.gpa_comparison?.class_median || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="performance-ranking-section">
                            <h6><i class="fas fa-trophy"></i> ترتيب الأداء</h6>
                            <div class="performance-ranking">
                                <div class="ranking-item">
                                    <span class="ranking-category">الأداء العام</span>
                                    <span class="ranking-value">${peerData.performance_ranking?.overall || 'غير محدد'}</span>
                                </div>
                                <div class="ranking-item">
                                    <span class="ranking-category">المعدل التراكمي</span>
                                    <span class="ranking-value">${peerData.performance_ranking?.gpa || 'غير محدد'}</span>
                                </div>
                                <div class="ranking-item">
                                    <span class="ranking-category">الحضور</span>
                                    <span class="ranking-value">${peerData.performance_ranking?.attendance || 'غير محدد'}</span>
                                </div>
                                <div class="ranking-item">
                                    <span class="ranking-category">المشاركة</span>
                                    <span class="ranking-value">${peerData.performance_ranking?.participation || 'غير محدد'}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="peer-benchmarks-section">
                            <h6><i class="fas fa-target"></i> معايير الأقران</h6>
                            <div class="peer-benchmarks">
                                <div class="benchmark-item top-10">
                                    <span class="benchmark-label">أعلى 10%</span>
                                    <span class="benchmark-value">${peerData.peer_benchmarks?.top_10_percent || 'N/A'}</span>
                                </div>
                                <div class="benchmark-item top-25">
                                    <span class="benchmark-label">أعلى 25%</span>
                                    <span class="benchmark-value">${peerData.peer_benchmarks?.top_25_percent || 'N/A'}</span>
                                </div>
                                <div class="benchmark-item median">
                                    <span class="benchmark-label">الوسيط</span>
                                    <span class="benchmark-value">${peerData.peer_benchmarks?.median || 'N/A'}</span>
                                </div>
                                <div class="benchmark-item bottom-25">
                                    <span class="benchmark-label">أدنى 25%</span>
                                    <span class="benchmark-value">${peerData.peer_benchmarks?.bottom_25_percent || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات مقارنة الأقران متاحة</div>';
            }
        }
        
        function displayPredictions(data) {
            const container = document.getElementById('predictions-container');
            console.log('بيانات التوقعات المستلمة:', data);
            
            // التحقق من هيكل البيانات
            let predictionsData = data;
            if (data && data.data) {
                predictionsData = data.data;
            }
            
            if (predictionsData && predictionsData.graduation_prediction) {
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-crystal-ball"></i> التوقعات الأكاديمية</h5>
                            <span class="performance-badge ${predictionsData.graduation_prediction.on_track ? 'badge-success' : 'badge-warning'}">
                                ${predictionsData.graduation_prediction.on_track ? 'في المسار الصحيح' : 'يحتاج تحسين'}
                            </span>
                        </div>
                        
                        <div class="graduation-prediction-section">
                            <h6><i class="fas fa-graduation-cap"></i> توقعات التخرج</h6>
                            <div class="graduation-info">
                                <div class="graduation-item">
                                    <strong>التخرج المتوقع:</strong> ${predictionsData.graduation_prediction.expected_graduation}
                                </div>
                                <div class="graduation-item">
                                    <strong>مستوى الثقة:</strong> ${predictionsData.graduation_prediction.confidence}%
                                </div>
                                <div class="graduation-item">
                                    <strong>الحالة:</strong> 
                                    <span class="${predictionsData.graduation_prediction.on_track ? 'text-success' : 'text-warning'}">
                                        ${predictionsData.graduation_prediction.on_track ? 'في المسار الصحيح' : 'يحتاج تحسين'}
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="gpa-predictions-section">
                            <h6><i class="fas fa-chart-line"></i> توقعات المعدل التراكمي</h6>
                            <div class="gpa-predictions">
                                <div class="prediction-item">
                                    <span class="prediction-period">الفصل القادم</span>
                                    <span class="prediction-value">${predictionsData.gpa_predictions?.next_semester || 'N/A'}</span>
                                </div>
                                <div class="prediction-item">
                                    <span class="prediction-period">نهاية العام</span>
                                    <span class="prediction-value">${predictionsData.gpa_predictions?.end_of_year || 'N/A'}</span>
                                </div>
                                <div class="prediction-item">
                                    <span class="prediction-period">عند التخرج</span>
                                    <span class="prediction-value">${predictionsData.gpa_predictions?.graduation || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="risk-predictions-section">
                            <h6><i class="fas fa-exclamation-triangle"></i> توقعات المخاطر</h6>
                            <div class="risk-predictions">
                                <div class="risk-item">
                                    <span class="risk-type">الإنذار الأكاديمي</span>
                                    <span class="risk-probability">${predictionsData.risk_predictions?.academic_probation || 0}%</span>
                                </div>
                                <div class="risk-item">
                                    <span class="risk-type">رسوب في مادة</span>
                                    <span class="risk-probability">${predictionsData.risk_predictions?.course_failure || 0}%</span>
                                </div>
                                <div class="risk-item">
                                    <span class="risk-type">مشاكل في الحضور</span>
                                    <span class="risk-probability">${predictionsData.risk_predictions?.attendance_issues || 0}%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="predictions-recommendations-section">
                            <h6><i class="fas fa-lightbulb"></i> توصيات للتطوير</h6>
                            <ul class="predictions-recommendations">
                                ${predictionsData.recommendations ? predictionsData.recommendations.map(rec => `
                                    <li><i class="fas fa-check-circle"></i> ${rec}</li>
                                `).join('') : '<li>لا توجد توصيات محددة</li>'}
                            </ul>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات التوقعات متاحة</div>';
            }
        }
        
        function getPercentileClass(percentile) {
            if (percentile >= 90) return 'badge-success';
            if (percentile >= 75) return 'badge-warning';
            if (percentile >= 50) return 'badge-info';
            return 'badge-secondary';
        }
        
        function displayInterventions(data) {
            const container = document.getElementById('interventions-container');
            console.log('بيانات التدخلات المستلمة:', data);
            let interventionsData = data;
            if (data && data.data) {
                interventionsData = data.data;
            }
            if (interventionsData && interventionsData.recommended_interventions) {
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-hands-helping"></i> التدخلات الأكاديمية</h5>
                        </div>
                        <div class="interventions-section">
                            <h6><i class="fas fa-lightbulb"></i> التدخلات الموصى بها</h6>
                            <ul class="interventions-list">
                                ${interventionsData.recommended_interventions.map(item => `
                                    <li class="intervention-item recommended">
                                        <strong>${item.title}</strong> - ${item.description}
                                        <span class="badge badge-info">${item.status}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                        <div class="interventions-section">
                            <h6><i class="fas fa-check-circle"></i> التدخلات المكتملة</h6>
                            <ul class="interventions-list">
                                ${interventionsData.completed_interventions.map(item => `
                                    <li class="intervention-item completed">
                                        <strong>${item.title}</strong> - ${item.description}
                                        <span class="badge badge-success">${item.status}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد بيانات تدخلات متاحة</div>';
            }
        }
        
        function displayAIInsights(data) {
            const container = document.getElementById('ai-insights-container');
            console.log('بيانات رؤى الذكاء الاصطناعي المستلمة:', data);
            let aiData = data;
            if (data && data.data) {
                aiData = data.data;
            }
            if (aiData && aiData.personalized_tips) {
                container.innerHTML = `
                    <div class="performance-card">
                        <div class="performance-header">
                            <h5><i class="fas fa-robot"></i> رؤى الذكاء الاصطناعي</h5>
                        </div>
                        <div class="ai-tips-section">
                            <h6><i class="fas fa-lightbulb"></i> نصائح مخصصة</h6>
                            <ul class="ai-tips-list">
                                ${aiData.personalized_tips.map(tip => `<li><i class="fas fa-check-circle"></i> ${tip}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="ai-flags-section">
                            <h6><i class="fas fa-exclamation-triangle"></i> تحذيرات الذكاء الاصطناعي</h6>
                            <ul class="ai-flags-list">
                                ${aiData.ai_flags.map(flag => `<li class="ai-flag"><span class="badge badge-danger">${flag.type}</span> ${flag.message}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="ai-opportunities-section">
                            <h6><i class="fas fa-bolt"></i> فرص الذكاء الاصطناعي</h6>
                            <ul class="ai-opportunities-list">
                                ${aiData.ai_opportunities.map(opp => `<li class="ai-opportunity"><span class="badge badge-success">${opp.type}</span> ${opp.message}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<div class="alert alert-warning">لا توجد رؤى ذكاء اصطناعي متاحة</div>';
            }
        }
    </script>
</body>
</html> 